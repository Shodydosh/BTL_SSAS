USE IDB;
GO

-- Delete data from fact tables first to maintain referential integrity
DELETE FROM MAT_HANG_DUOC_DAT;
DELETE FROM DON_DAT_HANG;
DELETE FROM MAT_HANG_LUU_TRU;

-- Delete data from dimension tables
DELETE FROM KHACH_HANG_DU_LICH;
DELETE FROM KHACH_HANG_BUU_DIEN;
DELETE FROM KHACH_HANG;
DELETE FROM CUA_HANG;
DELETE FROM MAT_HANG;
DELETE FROM THANH_PHO;
GO

-- Populating THANH_PHO (Cities)
INSERT INTO THANH_PHO (MaThanhPho, TenThanhPho, DiaChiVP, Bang, NgayThanhLapVP) VALUES
('TP001', 'Ho Chi Minh', '123 Nguyen Hue Blvd', 'South', CONVERT(DATE, '2000-01-15'));
INSERT INTO THANH_PHO (MaThanhPho, TenThanhPho, DiaChiVP, Bang, NgayThanhLapVP) VALUES
('TP002', 'Ha Noi', '456 Ba Dinh Square', 'North', CONVERT(DATE, '1998-10-10'));
INSERT INTO THANH_PHO (MaThanhPho, TenThanhPho, DiaChiVP, Bang, NgayThanhLapVP) VALUES
('TP003', 'Da Nang', '789 Bach Dang St', 'Central', CONVERT(DATE, '2005-05-20'));
INSERT INTO THANH_PHO (MaThanhPho, TenThanhPho, DiaChiVP, Bang, NgayThanhLapVP) VALUES
('TP004', 'Can Tho', '101 Hoa Binh Ave', 'Mekong Delta', CONVERT(DATE, '2008-03-30'));
INSERT INTO THANH_PHO (MaThanhPho, TenThanhPho, DiaChiVP, Bang, NgayThanhLapVP) VALUES
('TP005', 'Nha Trang', '202 Tran Phu St', 'Central Coast', CONVERT(DATE, '2010-12-05'));
GO

-- Populating CUA_HANG (Stores)
INSERT INTO CUA_HANG (MaCuaHang, MaThanhPho, SoDienThoai, NgayThanhLap) VALUES
('CH001', 'TP001', '0901234567', CONVERT(DATE, '2010-03-15'));
INSERT INTO CUA_HANG (MaCuaHang, MaThanhPho, SoDienThoai, NgayThanhLap) VALUES
('CH002', 'TP001', '0901234568', CONVERT(DATE, '2012-06-20'));
INSERT INTO CUA_HANG (MaCuaHang, MaThanhPho, SoDienThoai, NgayThanhLap) VALUES
('CH003', 'TP002', '0901234569', CONVERT(DATE, '2011-01-10'));
INSERT INTO CUA_HANG (MaCuaHang, MaThanhPho, SoDienThoai, NgayThanhLap) VALUES
('CH004', 'TP002', '0901234570', CONVERT(DATE, '2015-09-05'));
INSERT INTO CUA_HANG (MaCuaHang, MaThanhPho, SoDienThoai, NgayThanhLap) VALUES
('CH005', 'TP003', '0901234571', CONVERT(DATE, '2013-11-22'));
INSERT INTO CUA_HANG (MaCuaHang, MaThanhPho, SoDienThoai, NgayThanhLap) VALUES
('CH006', 'TP004', '0901234572', CONVERT(DATE, '2016-04-18'));
INSERT INTO CUA_HANG (MaCuaHang, MaThanhPho, SoDienThoai, NgayThanhLap) VALUES
('CH007', 'TP005', '0901234573', CONVERT(DATE, '2014-08-30'));
GO

-- Populating MAT_HANG (Products)
INSERT INTO MAT_HANG (MaMH, MoTa, KichCo, TrongLuong, Gia, NgayBatDauBan) VALUES
('MH001', 'Smartphone Galaxy S23', 6.1, 0.2, 799.99, CONVERT(DATE, '2023-01-15'));
INSERT INTO MAT_HANG (MaMH, MoTa, KichCo, TrongLuong, Gia, NgayBatDauBan) VALUES
('MH002', 'Laptop ThinkPad X1', 14.0, 1.5, 1299.99, CONVERT(DATE, '2022-11-10'));
INSERT INTO MAT_HANG (MaMH, MoTa, KichCo, TrongLuong, Gia, NgayBatDauBan) VALUES
('MH003', 'Wireless Earbuds', 2.0, 0.05, 129.99, CONVERT(DATE, '2022-06-20'));
INSERT INTO MAT_HANG (MaMH, MoTa, KichCo, TrongLuong, Gia, NgayBatDauBan) VALUES
('MH004', 'Smart Watch Series 8', 1.8, 0.1, 399.99, CONVERT(DATE, '2023-03-05'));
INSERT INTO MAT_HANG (MaMH, MoTa, KichCo, TrongLuong, Gia, NgayBatDauBan) VALUES
('MH005', 'Bluetooth Speaker', 8.0, 0.8, 89.99, CONVERT(DATE, '2022-09-15'));
INSERT INTO MAT_HANG (MaMH, MoTa, KichCo, TrongLuong, Gia, NgayBatDauBan) VALUES
('MH006', 'Gaming Console Pro', 30.0, 4.2, 499.99, CONVERT(DATE, '2022-12-01'));
INSERT INTO MAT_HANG (MaMH, MoTa, KichCo, TrongLuong, Gia, NgayBatDauBan) VALUES
('MH007', 'Digital Camera 4K', 12.0, 0.7, 649.99, CONVERT(DATE, '2023-02-10'));
INSERT INTO MAT_HANG (MaMH, MoTa, KichCo, TrongLuong, Gia, NgayBatDauBan) VALUES
('MH008', 'Tablet Pro 12.9', 12.9, 0.8, 899.99, CONVERT(DATE, '2022-10-20'));
INSERT INTO MAT_HANG (MaMH, MoTa, KichCo, TrongLuong, Gia, NgayBatDauBan) VALUES
('MH009', 'Fitness Tracker', 1.5, 0.03, 79.99, CONVERT(DATE, '2022-08-05'));
INSERT INTO MAT_HANG (MaMH, MoTa, KichCo, TrongLuong, Gia, NgayBatDauBan) VALUES
('MH010', 'Wireless Keyboard', 35.0, 0.6, 59.99, CONVERT(DATE, '2022-07-15'));
GO

-- Populating KHACH_HANG (Customers)
INSERT INTO KHACH_HANG (MaKH, TenKH, MaThanhPho, NgayDatHangDauTien) VALUES
('KH001', 'Nguyen Van A', 'TP001', CONVERT(DATE, '2023-01-20'));
INSERT INTO KHACH_HANG (MaKH, TenKH, MaThanhPho, NgayDatHangDauTien) VALUES
('KH002', 'Tran Thi B', 'TP002', CONVERT(DATE, '2023-01-25'));
INSERT INTO KHACH_HANG (MaKH, TenKH, MaThanhPho, NgayDatHangDauTien) VALUES
('KH003', 'Le Van C', 'TP003', CONVERT(DATE, '2023-02-05'));
INSERT INTO KHACH_HANG (MaKH, TenKH, MaThanhPho, NgayDatHangDauTien) VALUES
('KH004', 'Pham Thi D', 'TP001', CONVERT(DATE, '2023-02-10'));
INSERT INTO KHACH_HANG (MaKH, TenKH, MaThanhPho, NgayDatHangDauTien) VALUES
('KH005', 'Hoang Van E', 'TP004', CONVERT(DATE, '2023-02-15'));
INSERT INTO KHACH_HANG (MaKH, TenKH, MaThanhPho, NgayDatHangDauTien) VALUES
('KH006', 'Nguyen Thi F', 'TP005', CONVERT(DATE, '2023-03-01'));
INSERT INTO KHACH_HANG (MaKH, TenKH, MaThanhPho, NgayDatHangDauTien) VALUES
('KH007', 'Tran Van G', 'TP002', CONVERT(DATE, '2023-03-05'));
INSERT INTO KHACH_HANG (MaKH, TenKH, MaThanhPho, NgayDatHangDauTien) VALUES
('KH008', 'Phan Thi H', 'TP003', CONVERT(DATE, '2023-03-10'));
GO

-- Populating KHACH_HANG_BUU_DIEN (Postal Customers)
INSERT INTO KHACH_HANG_BUU_DIEN (MaKH, DiaChiBuuDien) VALUES
('KH001', '123 Nguyen Trai St, District 1, Ho Chi Minh City');
INSERT INTO KHACH_HANG_BUU_DIEN (MaKH, DiaChiBuuDien) VALUES
('KH004', '456 Le Loi St, District 5, Ho Chi Minh City');
INSERT INTO KHACH_HANG_BUU_DIEN (MaKH, DiaChiBuuDien) VALUES
('KH007', '789 Tran Hung Dao St, Ba Dinh District, Hanoi');
GO

-- Populating KHACH_HANG_DU_LICH (Tourist Customers)
INSERT INTO KHACH_HANG_DU_LICH (MaKH, HuongDanVien) VALUES
('KH003', 'Tran Van Tour');
INSERT INTO KHACH_HANG_DU_LICH (MaKH, HuongDanVien) VALUES
('KH006', 'Le Thi Guide');
INSERT INTO KHACH_HANG_DU_LICH (MaKH, HuongDanVien) VALUES
('KH008', 'Nguyen Van Travel');
GO

-- Populating DON_DAT_HANG (Orders) - Explicitly listing columns to avoid timestamp issue
INSERT INTO DON_DAT_HANG (MaDon, ThoiGianDatHang, MaKH) VALUES
('DH001', CONVERT(DATETIME, '2023-01-20 10:30:00'), 'KH001');
INSERT INTO DON_DAT_HANG (MaDon, ThoiGianDatHang, MaKH) VALUES
('DH002', CONVERT(DATETIME, '2023-01-25 14:15:00'), 'KH002');
INSERT INTO DON_DAT_HANG (MaDon, ThoiGianDatHang, MaKH) VALUES
('DH003', CONVERT(DATETIME, '2023-02-05 09:45:00'), 'KH003');
INSERT INTO DON_DAT_HANG (MaDon, ThoiGianDatHang, MaKH) VALUES
('DH004', CONVERT(DATETIME, '2023-02-10 16:20:00'), 'KH004');
INSERT INTO DON_DAT_HANG (MaDon, ThoiGianDatHang, MaKH) VALUES
('DH005', CONVERT(DATETIME, '2023-02-15 11:10:00'), 'KH005');
INSERT INTO DON_DAT_HANG (MaDon, ThoiGianDatHang, MaKH) VALUES
('DH006', CONVERT(DATETIME, '2023-03-01 13:30:00'), 'KH006');
INSERT INTO DON_DAT_HANG (MaDon, ThoiGianDatHang, MaKH) VALUES
('DH007', CONVERT(DATETIME, '2023-03-05 15:45:00'), 'KH007');
INSERT INTO DON_DAT_HANG (MaDon, ThoiGianDatHang, MaKH) VALUES
('DH008', CONVERT(DATETIME, '2023-03-10 10:00:00'), 'KH008');
INSERT INTO DON_DAT_HANG (MaDon, ThoiGianDatHang, MaKH) VALUES
('DH009', CONVERT(DATETIME, '2023-03-15 12:30:00'), 'KH001');
INSERT INTO DON_DAT_HANG (MaDon, ThoiGianDatHang, MaKH) VALUES
('DH010', CONVERT(DATETIME, '2023-03-20 14:00:00'), 'KH003');
GO

-- Populating MAT_HANG_DUOC_DAT (Order Items) - Explicitly listing columns to avoid timestamp issue
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH001', 'MH001', 1, 799.99, CONVERT(DATETIME, '2023-01-20 10:35:00'));
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH001', 'MH003', 2, 129.99, CONVERT(DATETIME, '2023-01-20 10:40:00'));
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH002', 'MH002', 1, 1299.99, CONVERT(DATETIME, '2023-01-25 14:20:00'));
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH003', 'MH005', 1, 89.99, CONVERT(DATETIME, '2023-02-05 09:50:00'));
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH003', 'MH009', 2, 79.99, CONVERT(DATETIME, '2023-02-05 09:55:00'));
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH004', 'MH004', 1, 399.99, CONVERT(DATETIME, '2023-02-10 16:25:00'));
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH005', 'MH006', 1, 499.99, CONVERT(DATETIME, '2023-02-15 11:15:00'));
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH006', 'MH008', 1, 899.99, CONVERT(DATETIME, '2023-03-01 13:35:00'));
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH007', 'MH007', 1, 649.99, CONVERT(DATETIME, '2023-03-05 15:50:00'));
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH008', 'MH010', 2, 59.99, CONVERT(DATETIME, '2023-03-10 10:05:00'));
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH009', 'MH003', 1, 129.99, CONVERT(DATETIME, '2023-03-15 12:35:00'));
INSERT INTO MAT_HANG_DUOC_DAT (MaDon, MaMH, SoLuong, GiaDat, ThoiGianDat) VALUES
('DH010', 'MH001', 1, 799.99, CONVERT(DATETIME, '2023-03-20 14:05:00'));
GO

-- Populating MAT_HANG_LUU_TRU (Inventory) - Explicitly listing columns to avoid timestamp issue
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH001', 'MH001', 10, CONVERT(DATETIME, '2023-01-01 08:00:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH001', 'MH002', 5, CONVERT(DATETIME, '2023-01-01 08:30:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH001', 'MH003', 20, CONVERT(DATETIME, '2023-01-01 09:00:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH002', 'MH004', 15, CONVERT(DATETIME, '2023-01-01 08:00:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH002', 'MH005', 12, CONVERT(DATETIME, '2023-01-01 08:30:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH003', 'MH001', 8, CONVERT(DATETIME, '2023-01-01 08:00:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH003', 'MH006', 6, CONVERT(DATETIME, '2023-01-01 08:30:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH004', 'MH007', 7, CONVERT(DATETIME, '2023-01-01 08:00:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH004', 'MH008', 4, CONVERT(DATETIME, '2023-01-01 08:30:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH005', 'MH009', 25, CONVERT(DATETIME, '2023-01-01 08:00:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH005', 'MH010', 30, CONVERT(DATETIME, '2023-01-01 08:30:00'));
GO

-- Sale: DH001 on Jan 20 (1 MH001 and 2 MH003 from CH001)
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH001', 'MH001', 9, CONVERT(DATETIME, '2023-01-20 18:00:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH001', 'MH003', 18, CONVERT(DATETIME, '2023-01-20 18:00:00'));
GO

-- Sale: DH002 on Jan 25 (1 MH002 from CH001)
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH001', 'MH002', 4, CONVERT(DATETIME, '2023-01-25 18:00:00'));
GO

-- Restock on Feb 1
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH001', 'MH001', 15, CONVERT(DATETIME, '2023-02-01 10:00:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH001', 'MH003', 30, CONVERT(DATETIME, '2023-02-01 10:30:00'));
GO

-- Sale: DH003 on Feb 5 (1 MH005 from CH002 and 2 MH009 from CH005)
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH002', 'MH005', 11, CONVERT(DATETIME, '2023-02-05 18:00:00'));
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH005', 'MH009', 23, CONVERT(DATETIME, '2023-02-05 18:00:00'));
GO

-- Sale: DH004 on Feb 10 (1 MH004 from CH002)
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH002', 'MH004', 14, CONVERT(DATETIME, '2023-02-10 18:00:00'));
GO

-- Restock on Feb 10
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH002', 'MH005', 20, CONVERT(DATETIME, '2023-02-10 09:00:00'));
GO

-- Sale: DH005 on Feb 15 (1 MH006 from CH003)
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH003', 'MH006', 5, CONVERT(DATETIME, '2023-02-15 18:00:00'));
GO

-- Restock on Feb 15
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH003', 'MH006', 10, CONVERT(DATETIME, '2023-02-15 14:00:00'));
GO

-- Sale: DH006 on Mar 1 (1 MH008 from CH004)
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH004', 'MH008', 3, CONVERT(DATETIME, '2023-03-01 18:00:00'));
GO

-- Sale: DH007 on Mar 5 (1 MH007 from CH004)
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH004', 'MH007', 6, CONVERT(DATETIME, '2023-03-05 18:00:00'));
GO

-- Sale: DH008 on Mar 10 (2 MH010 from CH005)
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH005', 'MH010', 28, CONVERT(DATETIME, '2023-03-10 18:00:00'));
GO

-- Sale: DH009 on Mar 15 (1 MH003 from CH001)
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH001', 'MH003', 29, CONVERT(DATETIME, '2023-03-15 18:00:00'));
GO

-- Sale: DH010 on Mar 20 (1 MH001 from CH001)
INSERT INTO MAT_HANG_LUU_TRU (MaCuaHang, MaMH, SoLuong, ThoiGianNhapXuat) VALUES
('CH001', 'MH001', 14, CONVERT(DATETIME, '2023-03-20 18:00:00'));
GO